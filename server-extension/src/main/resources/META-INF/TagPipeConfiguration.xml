<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="TagPipeConfiguration">

    <typeAlias alias="TagPipeConfiguration" type="hsy.pipe.domain.TagPipeConfiguration" />
    
    <resultMap class="TagPipeConfiguration" id="TagPipeConfiguration">
        <result property="tagId" column="tag_id"/>
        <result property="tagType" column="tag_type"/>
        <result property="tagAddress" column="tag_address"/>
        <result property="tagPipeSize" column="tag_pipe_size"/>
        <result property="tagLowPressureLevel" column="tag_low_pressure_level"/>
        <result property="tagMaxPressureLevel" column="tag_max_pressure_level"/>
        <result property="tagMaxWaterTake" column="tag_max_water_take"/>
        <result property="tagMinPressureLevel" column="tag_min_pressure_level"/>
        <result property="tagBottomHeight" column="tag_bottom_height"/>
        <result property="tagLowTagHeight" column="tag_low_tag_height"/>
        <result property="tagBarrageHeight" column="tag_barrage_height"/>
        <result property="tagGroundHeight" column="tag_ground_height"/>
        <result property="tagOtherIssue" column="tag_other_issue"/>
        <result property="tagGeoJson" column="tag_geojson" jdbcType="VARCHAR" javaType="org.json.JSONObject"/>
        <result property="tagMunicipality" column="tag_municipality"/>
        <result property="tagNeighborhood" column="tag_neighborhood"/>
        <result property="tagBlock" column="tag_block"/>
        <result property="tagPlot" column="tag_plot"/>
    </resultMap>

    <parameterMap id="TagPipeInsertParameter" class="TagPipeConfiguration">
        <parameter property="tagType"/>
        <parameter property="tagAddress"/>
        <parameter property="tagPipeSize"/>
        <parameter property="tagLowPressureLevel"/>
        <parameter property="tagMaxPressureLevel"/>
        <parameter property="tagMaxWaterTake"/>
        <parameter property="tagMinPressureLevel"/>
        <parameter property="tagBottomHeight"/>
        <parameter property="tagLowTagHeight"/>
        <parameter property="tagBarrageHeight"/>
        <parameter property="tagGroundHeight"/>
        <parameter property="tagOtherIssue"/>
        <parameter property="tagGeoJson" jdbcType="VARCHAR" javaType="org.json.JSONObject"/>
        <parameter property="tagMunicipality"/>
        <parameter property="tagNeighborhood"/>
        <parameter property="tagBlock"/>
        <parameter property="tagPlot"/>
    </parameterMap>

    <parameterMap id="TagPipeUpdateParameter" class="TagPipeConfiguration">
        <parameter property="tagAddress"/>
        <parameter property="tagPipeSize"/>
        <parameter property="tagLowPressureLevel"/>
        <parameter property="tagMaxPressureLevel"/>
        <parameter property="tagMaxWaterTake"/>
        <parameter property="tagMinPressureLevel"/>
        <parameter property="tagBottomHeight"/>
        <parameter property="tagLowTagHeight"/>
        <parameter property="tagBarrageHeight"/>
        <parameter property="tagGroundHeight"/>
        <parameter property="tagOtherIssue"/>
        <parameter property="tagGeoJson" jdbcType="VARCHAR" javaType="org.json.JSONObject"/>
        <parameter property="tagId"/>
        <parameter property="tagMunicipality"/>
        <parameter property="tagNeighborhood"/>
        <parameter property="tagBlock"/>
        <parameter property="tagPlot"/>
    </parameterMap>

    <cacheModel type="LRU" id="tagpipe-cache" readOnly="true" serialize="false">
        <flushInterval minutes="15"/>
        <property name="CacheSize" value="100"/>
    </cacheModel>

    <select id="maxId" resultClass="int">
        SELECT max(tag_id) FROM oskari_tagpipes;
    </select>

    <statement id="findTagPipes" resultMap="TagPipeConfiguration">
        SELECT
        *
        FROM oskari_tagpipes
        ORDER BY tag_id ASC;
    </statement>
    
     <statement id="findTagPipeById" resultMap="TagPipeConfiguration" parameterClass="java.lang.Long">
        SELECT
        *
        FROM oskari_tagpipes
        WHERE tag_id=#tagpipe_id#;
    </statement>
    
    <statement id="delete" parameterClass="java.lang.Long">
        DELETE FROM oskari_tagpipes WHERE tag_id=#tagpipe_id#;
    </statement>

    <statement id="insert" parameterMap="TagPipeInsertParameter" >
        INSERT INTO oskari_tagpipes (
        tag_type,
        tag_address,
        tag_pipe_size,
        tag_low_pressure_level,
        tag_max_pressure_level,
        tag_max_water_take,
        tag_min_pressure_level,
        tag_bottom_height,
        tag_low_tag_height,
        tag_barrage_height,
        tag_ground_height,
        tag_other_issue,
        tag_geojson,
        tag_municipality,
        tag_neighborhood,
        tag_block,
        tag_plot)
        values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
    </statement>

    <statement id="update" parameterMap="TagPipeUpdateParameter">
   		UPDATE oskari_tagpipes
        SET
        tag_address=?,
        tag_pipe_size=?,
        tag_low_pressure_level=?,
        tag_max_pressure_level=?,
        tag_max_water_take=?,
        tag_min_pressure_level=?,
        tag_bottom_height=?,
        tag_low_tag_height=?,
        tag_barrage_height=?, 
        tag_ground_height=?,
        tag_other_issue=?,
        tag_geojson=?,
        tag_municipality=?,
        tag_neighborhood=?,
        tag_block=?,
        tag_plot=?
        WHERE tag_id = ?
    </statement>
</sqlMap>